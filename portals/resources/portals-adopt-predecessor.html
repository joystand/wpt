<!doctype html>
<body>
  <portal src="portals-adopt-predecessor-portal.html"></portal>
</body>
<script>
  var bc_loaded = new BroadcastChannel("portal-loaded");
  bc_loaded.onmessage = e => {
    document.querySelector("portal").activate().then(() => {
      window.portalHost.addEventListener("message", e => {
        var bc_test = new BroadcastChannel("portal-test");
        bc_test.postMessage("passed");
        bc_test.close();
      });
    });
    bc_loaded.close();
  };
</script>
